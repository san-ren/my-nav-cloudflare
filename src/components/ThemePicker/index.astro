---
import { Palette } from 'lucide-react';

// 引入拆分后的子组件 (推荐方式)
import ModeSection from './sections/ModeSection.astro';
import ColorSection from './sections/ColorSection.astro';
import AnimSection from './sections/AnimSection.astro';
import BgSection from './sections/BgSection.astro';
import BackupSection from './sections/BackupSection.astro';

// 如果你还没有拆分文件，直接把原来的那些 HTML 写在这里也可以
---

<div class="relative z-50" id="theme-picker-container">
  <button 
    id="theme-btn"
    class="p-2.5 bg-white/80 dark:bg-gray-800/80 backdrop-blur-md rounded-xl text-slate-500 hover:text-brand-600 hover:bg-slate-100 dark:hover:bg-gray-700 transition-all shadow-sm border border-slate-200/50 dark:border-gray-700/50"
    title="外观设置"
  >
    <Palette size={20} />
  </button>

  <div 
    id="theme-panel"
    class="absolute right-0 top-14 w-72 bg-white/95 dark:bg-gray-900/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 dark:border-gray-700/50 p-4 transform transition-all duration-200 origin-top-right scale-95 opacity-0 invisible select-none max-h-[calc(100vh-100px)] h-auto overflow-y-auto custom-scrollbar"
  >
    <ModeSection />

    <ColorSection />
    <hr class="border-slate-100 dark:border-gray-700/50 my-3" />

    <AnimSection />
    <hr class="border-slate-100 dark:border-gray-700/50 my-3" />

    <BgSection />
    <hr class="border-slate-100 dark:border-gray-700/50 my-3" />

    <BackupSection />
  </div>
</div>

<script>
  // 引入上一轮对话中生成的逻辑文件
  import { initThemePicker } from './theme-logic.js';

  // 1. 组件加载完成后初始化交互事件 (点击、拖拽等)
  initThemePicker();

  // 2. 监听 Astro 页面切换，重新绑定交互事件
  document.addEventListener('astro:after-swap', () => {
    initThemePicker();
  });
</script>

<style>
  /* 样式保持不变 */
  input[type=range] { accent-color: rgb(var(--color-brand-rgb)); }
  .custom-scrollbar::-webkit-scrollbar { width: 4px; }
  .custom-scrollbar::-webkit-scrollbar-thumb { background-color: rgba(156, 163, 175, 0.5); border-radius: 4px; }
</style>